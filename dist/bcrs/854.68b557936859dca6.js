"use strict";(self.webpackChunkbcrs=self.webpackChunkbcrs||[]).push([[854],{6854:(E,v,s)=>{s.r(v),s.d(v,{ServicesModule:()=>N});var p=s(6814),t=s(6223),c=s(2058),e=s(2029);let f=(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-services"]],decls:1,vars:0,template:function(o,n){1&o&&e._UZ(0,"router-outlet")},dependencies:[c.lC],encapsulation:2}),i})();var Z=s(9862);let g=(()=>{var r;class i{constructor(o){this.http=o}createServiceRepair(o){return this.http.post("/api/invoices/service-repair",{invoice:o})}}return(r=i).\u0275fac=function(o){return new(o||r)(e.LFG(Z.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),i})();function h(r,i){if(1&r&&(e.TgZ(0,"div",2)(1,"div",3)(2,"div",35),e._uU(3),e.qZA()()()),2&r){const a=e.oxw();e.xp6(3),e.hij(" ",a.errorMessage," ")}}function b(r,i){1&r&&(e.TgZ(0,"div")(1,"div",36),e._uU(2," customerFullName is required. "),e._UZ(3,"button",37),e.qZA()())}function A(r,i){1&r&&(e.TgZ(0,"div")(1,"div",36),e._uU(2," Email is required. "),e._UZ(3,"button",37),e.qZA()())}function T(r,i){1&r&&(e.TgZ(0,"div")(1,"div",36),e._uU(2," Please enter a valid email address. "),e._UZ(3,"button",37),e.qZA()())}function I(r,i){1&r&&(e.TgZ(0,"div")(1,"div",36),e._uU(2," Parts Amount is required and must be a non-negative number. "),e._UZ(3,"button",37),e.qZA()())}function S(r,i){1&r&&(e.TgZ(0,"div")(1,"div",36),e._uU(2," Labor Amount is required and must be a non-negative number. "),e._UZ(3,"button",37),e.qZA()())}const U=[{path:"",component:f,children:[{path:"service-repair",component:(()=>{var r;class i{constructor(o,n,l){this.fb=o,this.router=n,this.invoiceService=l,this.invoiceForm=this.fb.group({customerFullName:[null,t.kI.compose([t.kI.required])],customerEmail:[null,t.kI.compose([t.kI.required,t.kI.email])],partsAmount:[null,t.kI.compose([t.kI.required,t.kI.min(0)])],laborAmount:[null,t.kI.compose([t.kI.required,t.kI.min(0)])],lineItemTotal:[{value:0,disabled:!0}],invoiceTotal:[{value:0,disabled:!0}]}),this.errorMessage=""}createServiceRepair(){const o=this.invoiceForm.controls.customerFullName?.value||"",n=this.invoiceForm.controls.customerEmail?.value||"",l=this.invoiceForm.controls.partsAmount?.value||0,d=this.invoiceForm.controls.laborAmount?.value||0,u=this.invoiceForm.controls.lineItems?.value||[],y={customerFullName:o,customerEmail:n,partsAmount:l,laborAmount:d,lineItems:u,orderDate:this.generateOrderDate(),lineItemTotal:this.calculateLineItemTotal(u),invoiceTotal:l+d+this.calculateLineItemTotal(u)};this.invoiceService.createServiceRepair(y).subscribe({next:m=>{console.log("Invoice submitted successfully:",m),this.router.navigate(["/invoices"])},error:m=>{this.errorMessage=m.error.message?m.error.message:"Something went wrong, please contact the system admin."}})}generateOrderDate(){return(new Date).toISOString()}calculateLineItemTotal(o){return o.reduce((n,l)=>n+(l.price||0),0)}addLineItem(){this.invoiceForm.controls.lineItems.push(this.fb.group({name:[null,t.kI.required],price:[null,[t.kI.required,t.kI.min(0)]]}))}removeLineItem(o){this.invoiceForm.controls.lineItems.removeAt(o)}}return(r=i).\u0275fac=function(o){return new(o||r)(e.Y36(t.qu),e.Y36(c.F0),e.Y36(g))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-repair"]],decls:74,vars:8,consts:[[1,"order-form","my-4",2,"min-height","72vh"],[1,"container","pt-4"],[1,"row"],[1,"col-12"],[1,"mt-1"],[1,"col"],[1,"card","border-info","mb-3",2,"max-width","100%"],[1,"card-header"],[1,"fas","fa-users","text-success"],[1,"badge","badge-purple","badge-outlined",2,"cursor","pointer"],[1,"fas","fa-user-plus","text-purple"],[1,"card-body","text-info"],[1,"form-row"],[1,"col-md-4"],["id","customer",1,"form-control","custom-select"],["class","row",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"mb-3"],["for","txtCustomerFullName",1,"form-label"],["type","text","id","txtCustomerFullName","formControlName","customerFullName","required","",1,"form-control"],[4,"ngIf"],["for","txtCustomerEmail",1,"form-label"],["type","email","id","txtCustomerEmail","formControlName","customerEmail","required","",1,"form-control"],["for","partsAmount",1,"form-label"],["type","number","id","partsAmount","formControlName","partsAmount","required","","min","0",1,"form-control"],["for","laborAmount",1,"form-label"],["type","number","id","laborAmount","formControlName","laborAmount","required","","min","0",1,"form-control"],[1,"form-label"],["formArrayName","lineItems"],["for","lineItemTotal",1,"form-label"],["type","number","id","lineItemTotal","formControlName","lineItemTotal",1,"form-control"],["for","invoiceTotal",1,"form-label"],["type","number","id","invoiceTotal","formControlName","invoiceTotal",1,"form-control"],["type","submit",1,"action-button","px-5","py-3",3,"disabled"],[1,"alert","alert-danger"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"]],template:function(o,n){1&o&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e._uU(5,"Create New Service Repair"),e.qZA(),e.TgZ(6,"span"),e._uU(7,"Add a new service invoice"),e.qZA(),e._UZ(8,"hr",4),e.qZA(),e.TgZ(9,"div",5)(10,"div",6)(11,"div",7),e._UZ(12,"i",8),e._uU(13," Customer "),e.TgZ(14,"a",9),e._uU(15,"Add New "),e._UZ(16,"i",10),e.qZA()(),e.TgZ(17,"div",11)(18,"div",12)(19,"div",13)(20,"select",14)(21,"option"),e._uU(22,"-Customer-"),e.qZA(),e.TgZ(23,"option"),e._uU(24,"item.name item.lastname"),e.qZA()()(),e.TgZ(25,"div",13)(26,"span")(27,"label"),e._uU(28,"Phone:"),e.qZA(),e._uU(29," phoneCustomer "),e.qZA()(),e.TgZ(30,"div",13)(31,"span")(32,"label"),e._uU(33,"Address:"),e.qZA(),e._uU(34," addressCustomer "),e.qZA()()()()()(),e.TgZ(35,"div",3),e.YNc(36,h,4,1,"div",15),e.TgZ(37,"form",16),e.NdJ("ngSubmit",function(){return n.createServiceRepair()}),e.TgZ(38,"fieldset",17)(39,"div",18)(40,"label",19),e._uU(41,"Customer Full Name:"),e.qZA(),e._UZ(42,"input",20),e.qZA(),e.YNc(43,b,4,0,"div",21),e.TgZ(44,"div",18)(45,"label",22),e._uU(46,"Customer Email:"),e.qZA(),e._UZ(47,"input",23),e.qZA(),e.YNc(48,A,4,0,"div",21),e.YNc(49,T,4,0,"div",21),e.TgZ(50,"div",18)(51,"label",24),e._uU(52,"Parts Amount:"),e.qZA(),e._UZ(53,"input",25),e.qZA(),e.YNc(54,I,4,0,"div",21),e.TgZ(55,"div",18)(56,"label",26),e._uU(57,"Labor Amount:"),e.qZA(),e._UZ(58,"input",27),e.qZA(),e.YNc(59,S,4,0,"div",21),e.TgZ(60,"div",18)(61,"label",28),e._uU(62,"Line Items:"),e.qZA(),e._UZ(63,"div",29),e.qZA(),e.TgZ(64,"div",18)(65,"label",30),e._uU(66,"Line Item Total:"),e.qZA(),e._UZ(67,"input",31),e.qZA(),e.TgZ(68,"div",18)(69,"label",32),e._uU(70,"Invoice Total:"),e.qZA(),e._UZ(71,"input",33),e.qZA()(),e.TgZ(72,"button",34),e._uU(73," Create Invoice "),e.qZA()()()()()()),2&o&&(e.xp6(36),e.Q6J("ngIf",n.errorMessage),e.xp6(1),e.Q6J("formGroup",n.invoiceForm),e.xp6(6),e.Q6J("ngIf",n.invoiceForm.controls.customerFullName.touched&&n.invoiceForm.controls.customerFullName.hasError("required")),e.xp6(5),e.Q6J("ngIf",n.invoiceForm.controls.customerEmail.touched&&n.invoiceForm.controls.customerEmail.hasError("required")),e.xp6(1),e.Q6J("ngIf",n.invoiceForm.controls.customerEmail.touched&&n.invoiceForm.controls.customerEmail.hasError("customerEmail")),e.xp6(5),e.Q6J("ngIf",n.invoiceForm.controls.partsAmount.touched&&n.invoiceForm.controls.partsAmount.hasError("required")),e.xp6(5),e.Q6J("ngIf",n.invoiceForm.controls.laborAmount.touched&&n.invoiceForm.controls.laborAmount.hasError("required")),e.xp6(13),e.Q6J("disabled",!n.invoiceForm.valid))},dependencies:[p.O5,t._Y,t.YN,t.Kr,t.Fj,t.wV,t.JJ,t.JL,t.Q7,t.qQ,t.sg,t.u,t.CE]}),i})(),title:"Bcrs-team3: Service-Repair"},{path:"service-graph",component:(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-graph"]],decls:2,vars:0,template:function(o,n){1&o&&(e.TgZ(0,"p"),e._uU(1,"service-graph works!"),e.qZA())}}),i})(),title:"Bcrs-team3: Service-Graph"}],canActivate:[s(3706).p]}];let F=(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(U),c.Bz]}),i})(),N=(()=>{var r;class i{}return(r=i).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.ez,F,t.UX]}),i})()}}]);